{"version":3,"sources":["../../../../src/app/actions/instagram.ts","../../../../.next-internal/server/app/page/actions.js%20%28server%20actions%20loader%29"],"sourcesContent":["\"use server\"\r\n\r\nimport { prisma } from \"@/lib/prisma\"\r\nimport { revalidatePath } from \"next/cache\"\r\n\r\n// 1. Salvar Configurações (Token e Usuário)\r\nexport async function saveInstagramSettings(formData: FormData) {\r\n  const accessToken = formData.get(\"accessToken\") as string\r\n  const username = formData.get(\"username\") as string\r\n  const enabled = formData.get(\"enabled\") === \"on\"\r\n\r\n  // Verifica se já existe, se não cria, se sim atualiza (Padrão Singleton)\r\n  const existing = await prisma.instagramSettings.findFirst()\r\n\r\n  if (existing) {\r\n    await prisma.instagramSettings.update({\r\n      where: { id: existing.id },\r\n      data: { accessToken, username, enabled }\r\n    })\r\n  } else {\r\n    await prisma.instagramSettings.create({\r\n      data: { accessToken, username, enabled }\r\n    })\r\n  }\r\n\r\n  revalidatePath(\"/\") // Atualiza a home\r\n  revalidatePath(\"/admin/instagram\")\r\n  return { success: true }\r\n}\r\n\r\n// 2. Buscar Fotos do Instagram (Para o componente da Home)\r\nexport async function getInstagramFeed() {\r\n  try {\r\n    const settings = await prisma.instagramSettings.findFirst()\r\n\r\n    if (!settings || !settings.enabled || !settings.accessToken) {\r\n      return []\r\n    }\r\n\r\n    // URL da API do Instagram\r\n    const url = `https://graph.instagram.com/me/media?fields=id,caption,media_type,media_url,thumbnail_url,permalink&access_token=${settings.accessToken}&limit=8`\r\n\r\n    const response = await fetch(url, { next: { revalidate: 3600 } }) // Cache por 1 hora\r\n    \r\n    if (!response.ok) {\r\n      console.error(\"Erro ao buscar Instagram:\", await response.text())\r\n      return []\r\n    }\r\n\r\n    const data = await response.json()\r\n    return data.data || []\r\n\r\n  } catch (error) {\r\n    console.error(\"Erro no feed do Instagram:\", error)\r\n    return []\r\n  }\r\n}","export {getInstagramFeed as '00066019b3aa2203a2639d4362cd53710ea0697bdf'} from 'ACTIONS_MODULE0'\nexport {saveInstagramSettings as '401cceb71193a2a85cc773ad8dd23b72a4392e9fa2'} from 'ACTIONS_MODULE0'\n"],"names":[],"mappings":"wDAEA,EAAA,EAAA,CAAA,CAAA,OACA,EAAA,EAAA,CAAA,CAAA,OAGO,eAAe,EAAsB,CAAkB,EAC5D,IAAM,EAAc,EAAS,GAAG,CAAC,eAC3B,EAAW,EAAS,GAAG,CAAC,YACxB,EAAsC,OAA5B,EAAS,GAAG,CAAC,WAGvB,EAAW,MAAM,EAAA,MAAM,CAAC,iBAAiB,CAAC,SAAS,GAezD,OAbI,EACF,MAAM,EADM,AACN,MAAM,CAAC,iBAAiB,CAAC,MAAM,CAAC,CACpC,MAAO,CAAE,GAAI,EAAS,EAAE,AAAC,EACzB,KAAM,aAAE,EAAa,mBAAU,CAAQ,CACzC,GAEA,MAAM,EAAA,MAAM,CAAC,iBAAiB,CAAC,MAAM,CAAC,CACpC,KAAM,aAAE,EAAa,WAAU,SAAQ,CACzC,GAGF,CAAA,EAAA,EAAA,cAAA,AAAc,EAAC,KACf,CADoB,AACpB,EAAA,EAAA,cAAA,AADsC,AACxB,EAAC,oBACR,CAAE,SAAS,CAAK,CACzB,CAGO,eAAe,IACpB,GAAI,CACF,IAAM,EAAW,MAAM,EAAA,MAAM,CAAC,iBAAiB,CAAC,SAAS,GAEzD,GAAI,CAAC,GAAY,CAAC,EAAS,OAAO,EAAI,CAAC,EAAS,WAAW,CACzD,CAD2D,KACpD,EAAE,CAIX,IAAM,EAAM,CAAC,iHAAiH,EAAE,EAAS,WAAW,CAAC,QAAQ,CAAC,CAExJ,EAAW,MAAM,MAAM,EAAK,CAAE,KAAM,CAAE,WAAY,IAAK,CAAE,GAAG,AAElE,GAAI,CAAC,EAAS,EAAE,CAEd,CAFgB,MAChB,GAHmF,KAG3E,KAAK,CAAC,4BAA6B,MAAM,EAAS,IAAI,IACvD,EAAE,CAIX,MAAO,CADM,MAAM,EAAS,IAAI,EAAA,EACpB,IAAI,EAAI,EAAE,AAExB,CAAE,MAAO,EAAO,CAEd,OADA,QAAQ,KAAK,CAAC,6BAA8B,GACrC,EAAE,AACX,CACF,0CAlDsB,EAyBA,IAzBA,CAAA,EAAA,EAAA,uBAAA,EAAA,EAAA,6CAAA,MAyBA,CAAA,EAAA,EAAA,uBAAA,EAAA,EAAA,6CAAA,4FC/BtB,IAAA,EAAA,EAAA,CAAA,CAAA"}