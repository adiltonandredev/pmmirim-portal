module.exports=[24868,(a,b,c)=>{b.exports=a.x("fs/promises",()=>require("fs/promises"))},21526,a=>{"use strict";var b=a.i(24868),c=a.i(14747);async function d(a,e="general"){if(!a||"object"!=typeof a||!a.size)return"";try{let d=await a.arrayBuffer(),f=Buffer.from(d),g=a.name.replace(/[^a-zA-Z0-9.-]/g,"_"),h=`${Date.now()}-${g}`,i=(0,c.join)(process.cwd(),"public","uploads",e);await (0,b.mkdir)(i,{recursive:!0});let j=(0,c.join)(i,h);return await (0,b.writeFile)(j,f),`/uploads/${e}/${h}`}catch(a){return console.error(`Erro ao salvar arquivo em ${e}:`,a),""}}a.s(["saveFile",()=>d])},96484,a=>{"use strict";var b=a.i(37936),c=a.i(66518),d=a.i(18558),e=a.i(21526);async function f(a){try{let b=a.get("title"),f=a.get("summary"),g=a.get("content"),h="on"===a.get("published"),i=b.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(/\s+/g,"-").replace(/[^\w\-]+/g,"").replace(/\-\-+/g,"-");await c.prisma.post.findUnique({where:{slug:i}})&&(i=`${i}-${Date.now()}`);let j=a.get("coverImage"),k=await (0,e.saveFile)(j,"projects");if(!b)return{error:"O título do projeto é obrigatório."};return await c.prisma.post.create({data:{title:b,slug:i,summary:f||"",content:g||"",coverImage:k,published:h,type:"PROJECT",featured:!1}}),(0,d.revalidatePath)("/admin/institution/projects"),(0,d.revalidatePath)("/"),{success:!0}}catch(a){return console.error("Erro ao criar projeto:",a),{error:"Erro ao salvar projeto."}}}async function g(a){try{let b=a.get("id");if(!b)return{error:"ID não encontrado."};let f=a.get("title"),g=a.get("summary"),h=a.get("content"),i="on"===a.get("published"),j=a.get("coverImage"),k=a.get("existingCoverImage");return j&&j.size>0&&(k=await (0,e.saveFile)(j,"projects")),await c.prisma.post.update({where:{id:b},data:{title:f,summary:g,content:h,coverImage:k,published:i}}),(0,d.revalidatePath)("/admin/institution/projects"),(0,d.revalidatePath)("/"),{success:!0}}catch(a){return console.error("Erro ao atualizar:",a),{error:"Erro ao atualizar."}}}async function h(a){let b=a.get("id");if(b)try{await c.prisma.post.delete({where:{id:b}}),(0,d.revalidatePath)("/admin/institution/projects"),(0,d.revalidatePath)("/")}catch(a){console.error("Erro ao excluir:",a)}}(0,a.i(13095).ensureServerEntryExports)([f,g,h]),(0,b.registerServerReference)(f,"408840bc6909836447a24b541c943a12b2907865a2",null),(0,b.registerServerReference)(g,"4048d4f7fe9665c5eb6ae7caaca38cbc6fd552f7bb",null),(0,b.registerServerReference)(h,"40bbfe617e9171d2ab6f0290afa9966720ca7dd4ad",null),a.s(["createProject",()=>f,"deleteProject",()=>h,"updateProject",()=>g])},97814,a=>{"use strict";var b=a.i(96484);a.s([],61824),a.i(61824),a.s(["4048d4f7fe9665c5eb6ae7caaca38cbc6fd552f7bb",()=>b.updateProject,"408840bc6909836447a24b541c943a12b2907865a2",()=>b.createProject,"40bbfe617e9171d2ab6f0290afa9966720ca7dd4ad",()=>b.deleteProject],97814)}];

//# sourceMappingURL=%5Broot-of-the-server%5D__3132e81b._.js.map